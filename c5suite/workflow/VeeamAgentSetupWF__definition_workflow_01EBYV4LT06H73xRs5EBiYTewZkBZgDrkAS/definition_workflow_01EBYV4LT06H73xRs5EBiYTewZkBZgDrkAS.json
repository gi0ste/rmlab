{
  "workflow": {
    "unique_name": "definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS",
    "name": "Veeam Agent Setup",
    "title": "Veeam Agent Setup",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "https://pvt2020.s3-eu-west-1.amazonaws.com/AO/VeeamAgentWindows_4.0.0.1811.exe",
          "scope": "local",
          "name": "backup agent installer repo",
          "type": "datatype.string",
          "description": "Link to the backup agent installer for Windows",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FE1J9D4JP8U3jsEuisehw9hPMHJQWfie0",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "cgw001.multicloudservices.it",
          "scope": "local",
          "name": "cloud gateway - Ubuntu",
          "type": "datatype.string",
          "description": "DNS name or IP address of the Veeam Cloud gateway",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FD8M27ANPXR53yciYZmqVsbuTp3ngC3Tq",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "https://andreaveeam.s3-eu-west-1.amazonaws.com/VAC.CommunicationAgent.x64.msi",
          "scope": "local",
          "name": "management agent installer repo",
          "type": "datatype.string",
          "description": "link to the management agent .msi installer for Windows repo",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FE1HBP7JKKF5iq57KUzeZwIg2ODVfesxm",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "https://andreaveeam.s3-eu-west-1.amazonaws.com/configuration.xml",
          "scope": "local",
          "name": "backup configuration file repo",
          "type": "datatype.string",
          "description": "Link to the backup configuration XML that will be applied to windows workstation for unmanaged backup",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FE1UPNUWH251VNCU2ai6D1FDqlXqt08SY",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "https://pvt2020.s3-eu-west-1.amazonaws.com/AO/veeam_4.0.0.1961_amd64.deb",
          "scope": "local",
          "name": "veeam deb repo",
          "type": "datatype.string",
          "description": "Link to the repository to download veeam deb files for Ubuntu",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FD8DA7T65ZW7WIYuse4hxIvEo7W1eBbVu",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "https://pvt2020.s3-eu-west-1.amazonaws.com/AO/installLicense.cmd",
          "scope": "local",
          "name": "activating script repo",
          "type": "datatype.string",
          "description": "Link to the activating script used for importing and activate both license and configuration in activation mode",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FFRQ1AZ4EAM4wEb7irEkBC8h9Kj2Xzt7G",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "https://andreaveeam.s3-eu-west-1.amazonaws.com/Veeam-1000instances-backup-trial.lic",
          "scope": "local",
          "name": "veeam license repo",
          "type": "datatype.string",
          "description": "Link to the repository to download veeam license file",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FD8GNA9CVX91mSDGrgVKESLg0fmutY9yz",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "function Disable-ieESC\n\n{\n$AdminKey = “HKLM:\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components{A509B1A7-37EF-4b3f-8CFC-4F3A74704073}”\n$UserKey = “HKLM:\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components{A509B1A8-37EF-4b3f-8CFC-4F3A74704073}”\nSet-ItemProperty -Path $AdminKey -Name “IsInstalled” -Value 0\nSet-ItemProperty -Path $UserKey -Name “IsInstalled” -Value 0\nStop-Process -Name Explorer\nWrite-Host “IE Enhanced Security Configuration (ESC) has been disabled.” -ForegroundColor Green\n}",
          "scope": "static",
          "name": "IES_script",
          "type": "datatype.string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01EED6K18TAL71jVi05dxkCMwcu41nRbFCv",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "veaam_admin_password",
          "type": "datatype.secure_string",
          "description": "Use secure string to store veeam admin password before give it as input",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FE3KV1WPU4C1tV86jxVaY6BsY3ictVsR0",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "https://pvt2020.s3-eu-west-1.amazonaws.com/AO/veeamsnap_4.0.0.1961_all.deb",
          "scope": "local",
          "name": "veeamsnap deb repo",
          "type": "datatype.string",
          "description": "Link to the repository to download veeamsnap deb files for Ubuntu",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FD8C89PDOZX1C7g8n1vpYwRYYwbsWWHZU",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[CGW001.MULTICLOUDSERVICES.IT][ccs.admin]VCSP CCS LAB - Repo01",
          "scope": "local",
          "name": "backup repository - Ubuntu input",
          "type": "datatype.string",
          "description": "Cloud repository used for the workstation backup in Ubuntu. Check the format in ubuntu before to change the input",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FD8RKLEQJJ50Ph2Xx0P9tSjNeRjrmOVCF",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "NODE_ID",
          "type": "datatype.string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01EC0MZZWMS2J6GEpJJH2tkxwgh52Htin7t",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "CC_RUN_ID",
          "type": "datatype.string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01EBYW7LT5LQ84XPYTfBdHzxnemGsJNCh14",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "username VAC",
          "type": "datatype.string",
          "description": "VAC username made of tenant/username. Used as input for the VAC APIs workflow",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FE80BA0XHLP6V2xykJF5dca0YM0WYSpYb",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "CGW001.MULTICLOUDSERVICES.IT",
          "scope": "local",
          "name": "Cloud Gateway - Windows",
          "type": "datatype.string",
          "description": "Veeam Cloud gateway used in windows ",
          "is_required": false
        },
        "unique_name": "variable_workflow_01FE1RVV4WNC33RquMtKgw2f1jGAyIQ0xGz",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "depends_on": "CC",
      "description": "Installation and configuration of the Veeam management agent and the Veeam backup agent, depending on input parameters, on Ubuntu and Windows VM in any cloud.\nConfiguration of the backup policies via command line on the agent and via REST API exposed by the Veeam Service Provider Console (VSPC). \nThis workflow is part of the implementation of the Backup as a Service.\nThe agents binay files are retrieved by a S3 bucket via http.\nA license file is needed to install the agent on the VM.",
      "display_name": "Veeam Agent Setup",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "target_type": "ccsuite.integration_endpoint",
        "target_id": "definition_target_01f9IQgvQRJv3tvlqwR145Bbrye0toH0Q",
        "execute_on_workflow_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX",
        "name": "Get Workload Manager Context",
        "title": "Get Workload Manager Context",
        "type": "ccs.get_cloud_context",
        "base_type": "activity",
        "properties": {
          "action_id": "69",
          "action_timeout": 180,
          "cc_configuration": {
            "execute_action": "on_vm",
            "reboot_vm": false,
            "resource_mappings": [
              {
                "applied_to": {
                  "app_ids": [
                    {
                      "id": "63",
                      "name": "CentOS Sample"
                    },
                    {
                      "id": "57",
                      "name": "OpenCart"
                    },
                    {
                      "id": "55",
                      "name": "RedHat Sample"
                    },
                    {
                      "id": "490",
                      "name": "testWindowsWorkflow"
                    },
                    {
                      "id": "53",
                      "name": "Ubuntu Sample"
                    },
                    {
                      "id": "460",
                      "name": "WebLogic"
                    },
                    {
                      "id": "455",
                      "name": "WeblogicMedrec"
                    },
                    {
                      "id": "61",
                      "name": "Windows"
                    },
                    {
                      "id": "468",
                      "name": "WordPress-Veeam"
                    }
                  ]
                },
                "resource_type": "app_profile",
                "resource_type_meta_info": {
                  "app_profile": {
                    "app_ids": "All"
                  }
                }
              }
            ],
            "sync_vm": false,
            "wf_availability_type": "lifecycle"
          },
          "cc_run_id": "$workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.input.variable_workflow_01EBYW7LT5LQ84XPYTfBdHzxnemGsJNCh14$",
          "continue_on_failure": false,
          "display_name": "Get Workload Manager Context",
          "runtime_user": {
            "override_target_runtime_user": false,
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target": true,
            "target_id": "definition_target_01f9IQgvQRJv3tvlqwR145Bbrye0toH0Q"
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01EC0P9WN8QHJ1fbzrpTXZu3nThtK3zWbcX",
        "name": "JSONPath Query",
        "title": "Get Deployment Details",
        "type": "corejava.jsonpathquery",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "description": "JsonPath query to get the details of the workload manager deployment",
          "display_name": "Get Deployment Details",
          "input_json": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
          "jsonpath_queries": [
            {
              "jsonpath_query": "$.parameters.appParams[?(@.name==\"install_sw_agent\")].value",
              "jsonpath_query_name": "install_agent",
              "jsonpath_query_type": "string"
            },
            {
              "jsonpath_query": "$.parameters.appParams[?(@.name==\"parentJobName\")].value",
              "jsonpath_query_name": "parentJobName",
              "jsonpath_query_type": "string"
            },
            {
              "jsonpath_query": "$.name",
              "jsonpath_query_name": "appTierName",
              "jsonpath_query_type": "string"
            },
            {
              "jsonpath_query": "$.id",
              "jsonpath_query_name": "appTierId",
              "jsonpath_query_type": "string"
            },
            {
              "jsonpath_query": "$.virtualMachines[0].hostName",
              "jsonpath_query_name": "hostname",
              "jsonpath_query_type": "string"
            },
            {
              "jsonpath_query": "$.virtualMachines[0].virtualMachineId",
              "jsonpath_query_name": "vm_id",
              "jsonpath_query_type": "string"
            },
            {
              "jsonpath_query": "$.cloudFamily",
              "jsonpath_query_name": "cloud_environment",
              "jsonpath_query_type": "string"
            },
            {
              "jsonpath_query": "$.virtualMachines[0].privateIpAddr",
              "jsonpath_query_name": "ip_address",
              "jsonpath_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01EC0VRM8TWUH0M5iZD7CopZacImqWzwJHC",
        "name": "Generic CCS API Request",
        "title": "Get VM Details",
        "type": "ccs.api_request",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "api_body": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
          "api_call_method": "GET",
          "continue_on_failure": false,
          "description": "Get the details of the VM",
          "display_name": "Get VM Details",
          "relative_url": "/cloudcenter-ccm-backend/api/v1/virtualMachines/$activity.definition_activity_01EC0P9WN8QHJ1fbzrpTXZu3nThtK3zWbcX.output.jsonpath_queries.vm_id$",
          "runtime_user": {
            "override_target_runtime_user": false,
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target": true,
            "target_id": "definition_target_01f9IQgvQRJv3tvlqwR145Bbrye0toH0Q"
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01EC0XNWPQB2L10g7p7tdSQsTCEPrtLbSja",
        "name": "JSONPath Query",
        "title": "Get OS Type",
        "type": "corejava.jsonpathquery",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "description": "Get OS type",
          "display_name": "Get OS Type",
          "input_json": "$activity.definition_activity_01EC0VRM8TWUH0M5iZD7CopZacImqWzwJHC.output.response_body$",
          "jsonpath_queries": [
            {
              "jsonpath_query": "$.osName",
              "jsonpath_query_name": "os_name",
              "jsonpath_query_type": "string"
            },
            {
              "jsonpath_query": "$.nodeId",
              "jsonpath_query_name": "id_name",
              "jsonpath_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01EC112GG93HY2XQ5ZnzahPcbQCEmVyGPZv",
        "name": "Condition Block",
        "title": "Check OS",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "description": "Check the OS type",
          "display_name": "Check OS",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01EC112IPSG6F4YusTkbhjJSjIygB6wkADl",
            "name": "Condition Branch",
            "title": "Os_name = 'ubuntu'",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01EC0XNWPQB2L10g7p7tdSQsTCEPrtLbSja.output.jsonpath_queries.os_name$",
                "operator": "eq",
                "right_operand": "ubuntu"
              },
              "continue_on_failure": false,
              "description": "If the OS is Ubuntu",
              "display_name": "Os_name = 'ubuntu'",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA",
                "name": "JSONPath Query",
                "title": "Get Workload Manager Input",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "description": "Get the input given to workload manager when the 'INSERT NAME HERE' application profile is used for deployment",
                  "display_name": "Get Workload Manager Input",
                  "input_json": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.parameters.appParams[?(@.name==\"username_backup\")].value",
                      "jsonpath_query_name": "username",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.parameters.appParams[?(@.name==\"password_backup\")].value",
                      "jsonpath_query_name": "password",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.parameters.appParams[?(@.name==\"backup_job_name\")].value",
                      "jsonpath_query_name": "backup job name",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.parameters.appParams[?(@.name==\"backup_schedule\")].value",
                      "jsonpath_query_name": "backup schedule",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.parameters.appParams[?(@.name==\"backup_schedule_time\")].value",
                      "jsonpath_query_name": "backup schedule time",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01EUN82GT3RSJ6j14eyBxapbVPIyDrfEtZP",
                "name": "Install required dependencies",
                "title": "Install required dependencies",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Install required dependencies for Veeam Agent deployment",
                  "display_name": "Install required dependencies",
                  "input": {
                    "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                    "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                    "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                    "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                    "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                    "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "apt-get -y install dkms; apt-get -y install lvm2;",
                    "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "execute_on_this_target_group": true,
                    "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                  },
                  "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01EDQ94H1CBVS7crIGrBVl6Ag8pIpruvMV1",
                "name": "Download Veeam Agent",
                "title": "Download Veeam Agent",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Download the Veeam Backup Agent",
                  "display_name": "Download Veeam Agent",
                  "input": {
                    "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                    "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                    "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                    "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                    "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                    "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "curl $workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FD8C89PDOZX1C7g8n1vpYwRYYwbsWWHZU$ -o veeamsnap_4.0.0.1961_all.deb ; curl $workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FD8DA7T65ZW7WIYuse4hxIvEo7W1eBbVu$ -o veeam_4.0.0.1961_amd64.deb;",
                    "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "execute_on_this_target_group": true,
                    "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                  },
                  "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01FD7XSJF0E7Y1OpZgQJwsSh7W8YK23zitK",
                "name": "Download Veeam License",
                "title": "Download Veeam License",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Download the Veeam License",
                  "display_name": "Download Veeam License",
                  "input": {
                    "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                    "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                    "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                    "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                    "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                    "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "curl $workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FD8GNA9CVX91mSDGrgVKESLg0fmutY9yz$ -o license.lic",
                    "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "execute_on_this_target_group": true,
                    "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                  },
                  "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01EDQAVJ4665Z4YvY6L3KM2itWDNCBSxtC5",
                "name": "Install Veeam Agent",
                "title": "Install Veeam Agent",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": true,
                  "description": "Install the Veeam Agent .deb files in the VM",
                  "display_name": "Install Veeam Agent",
                  "input": {
                    "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                    "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                    "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                    "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                    "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                    "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "sudo dpkg -i ./veeamsnap*; sudo apt-get update; sudo dpkg -i ./veeam_*; apt-get update; apt-get -y install veeam;",
                    "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "execute_on_this_target_group": true,
                    "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                  },
                  "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01EFZPSLS56TL37X6NkTBxgsYnmYmpFNSj4",
                "name": "Accept Veeam Licenses",
                "title": "Accept Veeam Licenses",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Automatically accept license agreements in Veeam ",
                  "display_name": "Accept Veeam Licenses",
                  "input": {
                    "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                    "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                    "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                    "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                    "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                    "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "veeamconfig agreement accepteula; veeamconfig agreement acceptthirdpartylicenses;",
                    "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "execute_on_this_target_group": true,
                    "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                  },
                  "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01F5KHVJJ1DHT3UpvEe04fbg6I0fd1QhRzR",
                "name": "Install License",
                "title": "Install License",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Install Veeam license",
                  "display_name": "Install License",
                  "input": {
                    "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                    "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                    "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                    "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                    "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                    "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "veeamconfig license install --path license.lic --workstation",
                    "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "execute_on_this_target_group": true,
                    "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                  },
                  "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01F5KEUJHGKQ73cB7gxPQBtvibCkZFgxj0Y",
                "name": "Connect to Filippetti Veeam Cloud",
                "title": "Connect to Filippetti Veeam Cloud",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Connect to the Veeam Gateway",
                  "display_name": "Connect to Filippetti Veeam Cloud",
                  "input": {
                    "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                    "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                    "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                    "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                    "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                    "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "veeamconfig cloud add --address $workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FD8M27ANPXR53yciYZmqVsbuTp3ngC3Tq$ --port 6180 --login $activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.username$ --password $activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.password$",
                    "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "execute_on_this_target_group": true,
                    "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                  },
                  "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01F5KJ9LQWGET1Z4Xyxvp67TK3XpahZ1XWM",
                "name": "Define VM Backup Job",
                "title": "Define VM Backup Job",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Define a Backup Job for the VM",
                  "display_name": "Define VM Backup Job",
                  "input": {
                    "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                    "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                    "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                    "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                    "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                    "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "veeamconfig job create volumelevel --name $activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.backup job name$ --reponame '$workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FD8RKLEQJJ50Ph2Xx0P9tSjNeRjrmOVCF$' --backupallsystem",
                    "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "execute_on_this_target_group": true,
                    "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                  },
                  "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01FD9EUXOEXV35d2BpUf9rKzWDXTTGUf3wt",
                "name": "Condition Block",
                "title": "Check Scheduled Backup Type",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Check the input from workload manager to see if it is a daily or weekkly backup",
                  "display_name": "Check Scheduled Backup Type",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01FD9EV0I01HO1vVoI2D5ikEjOUgjgcTFqz",
                    "name": "Condition Branch",
                    "title": "schedule == daily",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.backup schedule$",
                        "operator": "eq",
                        "right_operand": "daily"
                      },
                      "continue_on_failure": false,
                      "description": "daily schedule input in workload manager, meaning that backup will happen daily",
                      "display_name": "schedule == daily",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01FD9CCW9AFOS7RQrOIUBXVRj4ZdRu6KrWU",
                        "name": "Set daily schedule",
                        "title": "Set daily schedule",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Set up daily schedule",
                          "display_name": "Set daily schedule",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "veeamconfig schedule set --jobName $activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.backup job name$ --daily --at $activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.backup schedule time$",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01FD9EV1E3OI01zSiBULZG4ZmmwhICMf9IW",
                    "name": "Condition Branch",
                    "title": "schedule == weekly",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.backup schedule$",
                        "operator": "ne",
                        "right_operand": "daily"
                      },
                      "continue_on_failure": false,
                      "description": "different weekdays schedule input in workload manager, meaning that backup will happen weekly",
                      "display_name": "schedule == weekly",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01FDBNIYVFT5E2Tk3vg10pO0gKXlxd1ypLL",
                        "name": "Set weekly schedule",
                        "title": "Set weekly schedule",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Set up weekly schedule considering weekdays in input from workload manager",
                          "display_name": "Set weekly schedule",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "veeamconfig schedule set --jobName $activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.backup job name$ --weekdays $activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.backup schedule$ --at $activity.definition_activity_01FD9GQE5X2SN3JcXG72nQnMPCPFHiDKBVA.output.jsonpath_queries.backup schedule time$",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01EC112JN7SVK6hMCh6OJ2jre0vXH3kizdA",
            "name": "Condition Branch",
            "title": "OS_NAME='Windows'",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$activity.definition_activity_01EC0XNWPQB2L10g7p7tdSQsTCEPrtLbSja.output.jsonpath_queries.os_name$",
                "operator": "mw",
                "right_operand": "Microsoft Windows*"
              },
              "continue_on_failure": false,
              "display_name": "OS_NAME='Windows'",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX",
                "name": "JSONPath Query",
                "title": "Get Workload Manager Input",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "description": "Get the input given to workload manager when the 'INSERT NAME HERE' application profile is used for deployment",
                  "display_name": "Get Workload Manager Input",
                  "input_json": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.parameters.appParams[?(@.name==\"username_backup\")].value",
                      "jsonpath_query_name": "username",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.parameters.appParams[?(@.name==\"password_backup\")].value",
                      "jsonpath_query_name": "password",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.parameters.appParams[?(@.name==\"tenant_backup\")].value",
                      "jsonpath_query_name": "tenant",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.parameters.appParams[?(@.name==\"backup_policy\")].value",
                      "jsonpath_query_name": "backup_policy",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01FE171CQOAZL48jFrv356j0hhSFNbrIGxt",
                "name": "Condition Block",
                "title": "Check backup management mode",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Check if the backup is going to be managed from the VAC (managed mode) or if it is going to happen in unmanaged mode.",
                  "display_name": "Check backup management mode",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01FE171FGI6OG76FaaeAwlZkXIAtC6W0vPI",
                    "name": "Condition Branch",
                    "title": "is backup policy == null",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX.output.jsonpath_queries.backup_policy$",
                        "operator": "eq",
                        "right_operand": "null"
                      },
                      "continue_on_failure": false,
                      "description": "If the input specify backup policy equal to null, it means that the backup is going to be configured from the command line, importing license and configuration file with existing policy and gateway configured",
                      "display_name": "is backup policy == null",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01FE19D04XWA33zmyy8MybVpf2mmLAXeo99",
                        "name": "Download Backup Agent",
                        "title": "Download Backup Agent",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Download the Veeam Backup Agent.\ncurl must be used because is the only command that apparently bypass the Enanched Security that Windows Server OS enables by default",
                          "display_name": "Download Backup Agent",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "curl $workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FE1J9D4JP8U3jsEuisehw9hPMHJQWfie0$ -Outfile BackupAgent.exe",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01EGTKV7GEGJB1hgMV1ZfasRQHD9EVAZXmZ",
                        "name": "Install Backup Agent",
                        "title": "Install Backup Agent",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Install Backup Agent from windows command line using powershell. That is because we had issue on execute this command directly from the command line.",
                          "display_name": "Install Backup Agent",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "powershell -command \\\"C:\\\\opt\\\\agentlite\\\\BackupAgent.exe \\/silent \\/accepteula \\/acceptthirdpartylicenses\\\"",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01F8AEG417AWD2GElmj0FSRLRs0C5KJ6s7F",
                        "name": "Download Veeam License file",
                        "title": "Download Veeam License file",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Download Veeam License.\ncurl must be used because is the only command that apparently bypass the Enanched Security that Windows Server OS enables by default",
                          "display_name": "Download Veeam License file",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "curl $workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FD8GNA9CVX91mSDGrgVKESLg0fmutY9yz$ -Outfile license.lic",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01F8AHCU8VQHK2aDFY5zE2iXqXrajaxkun2",
                        "name": "Download Configuration XML file",
                        "title": "Download Configuration XML file",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Donwload Veeam Backup configuration file used to import existing backup configured template into the Veaam Backup installed.\ncurl must be used because is the only command that apparently bypass the Enanched Security that Windows Server OS enables by default",
                          "display_name": "Download Configuration XML file",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "curl $workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FE1UPNUWH251VNCU2ai6D1FDqlXqt08SY$ -Outfile configuration.xml",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01FCMJXF9YKBT62QKal4jXv7Uf3QT8qIvL3",
                        "name": "Download Script To Enable Backup",
                        "title": "Download Script To Enable Backup",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Download the script to execute Veeam command to import license and configuration files.\n(Script used because single commands for different activities were not working).\ncurl must be used because is the only command that apparently bypass the Enanched Security that Windows Server OS enables by default",
                          "display_name": "Download Script To Enable Backup",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "curl $workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FFRQ1AZ4EAM4wEb7irEkBC8h9Kj2Xzt7G$ -Outfile license.cmd",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01FCMJA73B0MX13ShWyTgZrxkmi9ErW0zA3",
                        "name": "Execute Script To Enable Backup",
                        "title": "Execute Script To Enable Backup",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Import license file and configuration file into Veeam",
                          "display_name": "Execute Script To Enable Backup",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": ".\\\\license.cmd",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01FE171GCIGM03j6rLYIknw3Kurccam6YhX",
                    "name": "Condition Branch",
                    "title": "is backup policy not == NULL",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX.output.jsonpath_queries.backup_policy$",
                        "operator": "ne",
                        "right_operand": "null"
                      },
                      "continue_on_failure": false,
                      "description": "If backup policy is different from null, switch to managed mode",
                      "display_name": "is backup policy not == NULL",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01EDHO3YRK2P44WsRDciMzw7QEqXTmiol8W",
                        "name": "Download Management Agent",
                        "title": "Download Management Agent",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Download Veeam Management Agent.\ncurl must be used because is the only command that apparently bypass the Enanched Security that Windows Server OS enables by default",
                          "display_name": "Download Management Agent",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "curl $workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FE1HBP7JKKF5iq57KUzeZwIg2ODVfesxm$ -Outfile VAC.msi",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01F8ANA1AY05E3jOghiQymrm4sm8RCrTC7Y",
                        "name": "Install and configure VAC Management Agent",
                        "title": "Install and configure VAC Management Agent",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Powershell command to install VAC.msi file and configure it, allowing the VAC to discover the workstation.",
                          "display_name": "Install and configure VAC Management Agent",
                          "input": {
                            "variable_workflow_01gYxTTIiozpeC0G7XGX3h938xWZW4k92": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.action_type$",
                            "variable_workflow_01gmGB1E79m7TfL8YMDUFjfBqxcIAKSbf": "$activity.definition_activity_01EC0MHVBV8NN6ooU5Gg7iLb2szQEIwxteX.output.response_body$",
                            "variable_workflow_01gmT7gkCb94ey8Tqd849LGeJvdfmsYrq": 10,
                            "variable_workflow_01gmUjEx0Z3LZOPK3u01H2tmZyv1QIFk6": 30,
                            "variable_workflow_01gmdByUB9aPy15xbtjYiwCkddwX9OXBD": "null",
                            "variable_workflow_01gmgK3LkOa8JMelklBT5K2eV29ZlPpqv": "powershell -command msiexec.exe \\/qn \\/i \\\"C:\\\\opt\\\\agentlite\\\\VAC.msi\\\" ACCEPT_THIRDPARTY_LICENSES=\\\"1\\\" ACCEPT_EULA=\\\"1\\\" VAC_TENANT=\\\"$activity.definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX.output.jsonpath_queries.tenant$\\\\$activity.definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX.output.jsonpath_queries.username$\\\" VAC_TENANT_PASSWORD=\\\"$activity.definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX.output.jsonpath_queries.password$\\\" CC_GATEWAY=\\\"$workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FE1RVV4WNC33RquMtKgw2f1jGAyIQ0xGz$\\\" CC_GATEWAY_PORT=\\\"6180\\\"",
                            "variable_workflow_01grKo0w9ERN4QuKLJ3qgU5yoPCsn8CgI": "Suite Internal Target"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target_group": true,
                            "target_group_id": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I"
                          },
                          "workflow_id": "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01FE3JISP55ZP6qOzNwxfeMWIAcMvgkrihu",
                        "name": "Set Variables",
                        "title": "Set Inpput Variables for API calls",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "description": "Set password as secure string before give it as input for the workflow.\nSet username as tenant/username (future HTTP request will need username as tenant/username to make authentication works)",
                          "display_name": "Set Inpput Variables for API calls",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FE3KV1WPU4C1tV86jxVaY6BsY3ictVsR0$",
                              "variable_value_new": "$activity.definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX.output.jsonpath_queries.password$"
                            },
                            {
                              "variable_to_update": "$workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FE80BA0XHLP6V2xykJF5dca0YM0WYSpYb$",
                              "variable_value_new": "$activity.definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX.output.jsonpath_queries.tenant$\\$activity.definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX.output.jsonpath_queries.username$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01FE7UBCUG7E92bsgUbSFJbPmMsNUngXP59",
                        "name": "Veeam VAC Backup Agent Management",
                        "title": "Veeam VAC Backup Agent Management",
                        "type": "workflow.sub_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Veeam VAC Backup Agent Management",
                          "input": {
                            "variable_workflow_01FBGE0LAZ80B17EwFKqGlRtRLBNKQ3KFcF": "$workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FE80BA0XHLP6V2xykJF5dca0YM0WYSpYb$",
                            "variable_workflow_01FBGELC22EEE5eZIsqJDP7zeY1u8URAeOj": "$workflow.definition_workflow_01EBYV4LT06H73xRs5EBiYTewZkBZgDrkAS.local.variable_workflow_01FE3KV1WPU4C1tV86jxVaY6BsY3ictVsR0$",
                            "variable_workflow_01FC8YKL5AC2838ClnJtivjwkt6RiIMW6oU": "$activity.definition_activity_01FE0VF4R1M6O7IYp8zGNEK6GryvXqiXBRX.output.jsonpath_queries.backup_policy$",
                            "variable_workflow_01FC90D4QFUJJ4DMdybvmSfpV3vVppPFS9l": "$activity.definition_activity_01EC0P9WN8QHJ1fbzrpTXZu3nThtK3zWbcX.output.jsonpath_queries.hostname$",
                            "variable_workflow_01FGQMN2OU5XL0HXJ51sTLitZhvtdGRFTvo": "$activity.definition_activity_01EC0P9WN8QHJ1fbzrpTXZu3nThtK3zWbcX.output.jsonpath_queries.ip_address$",
                            "variable_workflow_01FGRK4F7QTTF3EVDAvqF9fJmXZB1rfdTfj": "$activity.definition_activity_01EC0P9WN8QHJ1fbzrpTXZu3nThtK3zWbcX.output.jsonpath_queries.cloud_environment$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target": true,
                            "target_id": "definition_target_01FA23LAB0U1W72OX6KHvP6VXtfZhoU8zUZ",
                            "target_type": "web-service.endpoint"
                          },
                          "workflow_id": "definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "targets": {
    "definition_target_01FA23LAB0U1W72OX6KHvP6VXtfZhoU8zUZ": {
      "unique_name": "definition_target_01FA23LAB0U1W72OX6KHvP6VXtfZhoU8zUZ",
      "name": "Filippetti VAC",
      "title": "Filippetti VAC",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "disable_certificate_validation": false,
        "display_name": "Filippetti VAC",
        "host": "vac.multicloudservices.it",
        "no_runtime_user": true,
        "port": 1280,
        "protocol": "https"
      }
    }
  },
  "target_groups": {
    "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I": {
      "unique_name": "target_group_01grjYGXnAlH7hYFqQwJCEPBTKItsKq0I",
      "name": "CCS Target Group",
      "title": "CCS Target Group",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "ccsuite.endpoint",
          "view_target_type": "ccsuite.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "ccsuite.integration_endpoint",
          "view_target_type": "ccsuite.integration_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "subworkflows": [
    {
      "workflow": {
        "unique_name": "definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X",
        "name": "Veeam VAC Backup Agent Management ",
        "title": "Veeam VAC Backup Agent Management ",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "null",
              "scope": "local",
              "name": "backup_agent_uid",
              "type": "datatype.string",
              "description": "Veeam Backup Agent Unique ID that Veeam associates to the Backup Agent installed in the workstation\nDefault value null used for the loop (once the value will be updated, loop will end)",
              "is_required": false
            },
            "unique_name": "variable_workflow_01FCK4Q2SIA5L2XnY9gSk315hocP6eQNLnt",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Cloud Provider",
              "type": "datatype.string",
              "description": "Cloud Environment in which the workstation is deplyed (insert Amazon if AWS, insert any other value for others)",
              "is_required": true
            },
            "unique_name": "variable_workflow_01FGRK4F7QTTF3EVDAvqF9fJmXZB1rfdTfj",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "CCS_LAB\\ccs.admin",
              "scope": "input",
              "name": "Username",
              "type": "datatype.string",
              "description": "Veeam Admin username",
              "is_required": true
            },
            "unique_name": "variable_workflow_01FBGE0LAZ80B17EwFKqGlRtRLBNKQ3KFcF",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Workstation hostname",
              "type": "datatype.string",
              "description": "Name of the workstation",
              "is_required": true
            },
            "unique_name": "variable_workflow_01FC90D4QFUJJ4DMdybvmSfpV3vVppPFS9l",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.integer",
            "properties": {
              "value": 10,
              "scope": "local",
              "name": "loop_counter",
              "type": "datatype.integer",
              "description": "Variable used to define the maximum number of loops. It will be decremented every loop, giving timeout errors when it reaches 0.",
              "is_required": false
            },
            "unique_name": "variable_workflow_01FGULDZQUH253YL4FCLRMica8cqsRTVMrJ",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.secure_string",
            "properties": {
              "value": "*****",
              "scope": "input",
              "name": "Password",
              "type": "datatype.secure_string",
              "description": "Veeam Admin password",
              "is_required": true
            },
            "unique_name": "variable_workflow_01FBGELC22EEE5eZIsqJDP7zeY1u8URAeOj",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "DEMO Workstation Policy",
              "scope": "input",
              "name": "Backup Policy",
              "type": "datatype.string",
              "description": "Veeam Backup Policy to apply to the workstation. It must be present among the one listed in the VAC",
              "is_required": true
            },
            "unique_name": "variable_workflow_01FC8YKL5AC2838ClnJtivjwkt6RiIMW6oU",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "null",
              "scope": "local",
              "name": "veeam_workstation_uid",
              "type": "datatype.string",
              "description": "Workstation unique ID given by Veeam once the workstation has been discovered\nDefault value null used for the loop (once the value will be updated, loop will end)",
              "is_required": false
            },
            "unique_name": "variable_workflow_01FE9SB8BSU3M3LPS0XTGrCQIcM5lsMp1u8",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "local",
              "name": "access_token",
              "type": "datatype.string",
              "description": "Access Token given by the VAC API once authenticated",
              "is_required": false
            },
            "unique_name": "variable_workflow_01FBGA0NW0P2I2tECsbPcp3zukSGhOTYyoc",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Workstation IP address",
              "type": "datatype.string",
              "description": "Workstation IP address used to get the specific discovered computer ",
              "is_required": true
            },
            "unique_name": "variable_workflow_01FGQMN2OU5XL0HXJ51sTLitZhvtdGRFTvo",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "description": "Manages the installation and configuration of the backup agent using the Veeam VSPC (aka VAC) API",
          "display_name": "Veeam VAC Backup Agent Management ",
          "runtime_user": {
            "override_target_runtime_user": false,
            "specify_on_workflow_start": false,
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "target_id": "definition_target_01FA23LAB0U1W72OX6KHvP6VXtfZhoU8zUZ",
            "execute_on_workflow_target": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_01FBP4PTRX9OE1aeMXKiN4VFx8maRrgDbhn",
            "name": "HTTP Request",
            "title": "VAC Authentication",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "accept": "application/json",
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "body": "grant_type=password\u0026username=$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FBGE0LAZ80B17EwFKqGlRtRLBNKQ3KFcF$\u0026password=$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FBGELC22EEE5eZIsqJDP7zeY1u8URAeOj$",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "Content-Type",
                  "value": "application/x-www-form-urlencoded"
                }
              ],
              "description": "HTTP GET request for OAuth 2.0 authentication to the VAC",
              "display_name": "VAC Authentication",
              "method": "POST",
              "relative_url": "api/v3/token",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": false,
                "override_workflow_target_group_criteria": false,
                "use_workflow_target": true,
                "use_workflow_target_group": false
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01FBPPR3WMFBP5yDzIhtuVVKCjuyQFlvGJz",
            "name": "JSONPath Query",
            "title": "Get Authorization Token ",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "description": "JsonPath query to the body of the previous HTTP GET request to get the access token that is going to be used in the other API calls",
              "display_name": "Get Authorization Token ",
              "input_json": "$activity.definition_activity_01FBP4PTRX9OE1aeMXKiN4VFx8maRrgDbhn.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.access_token",
                  "jsonpath_query_name": "access_token",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01FAYKRSPAPBJ3E3XAMFzwNOzB837FkYU3a",
            "name": "Condition Block",
            "title": "Authentication Check",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "description": "Check if the authentication was successful ",
              "display_name": "Authentication Check",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01FAYKRUZFT066q7aPS8kbhZMvDyFWkIQl0",
                "name": "Condition Branch",
                "title": "Authentication Failed",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01FBP4PTRX9OE1aeMXKiN4VFx8maRrgDbhn.output.response_body$",
                    "operator": "nmw",
                    "right_operand": "*access_token*"
                  },
                  "continue_on_failure": false,
                  "description": "The access token cannot be found in the body, meaning the authentication has failed.",
                  "display_name": "Authentication Failed",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01FF1PB2VOK6E0cggXWyRq1MUO4x5cNI3sf",
                    "name": "Failed",
                    "title": "Completed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "display_name": "Failed",
                      "result_message": "Authentication Failed"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01FAYW2ZKRIE31uCjQrYGE1d3t7V7SOSJSn",
                "name": "Condition Branch",
                "title": "Authentication Suceeded",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01FBP4PTRX9OE1aeMXKiN4VFx8maRrgDbhn.output.response_body$",
                    "operator": "mw",
                    "right_operand": "*access_token*"
                  },
                  "continue_on_failure": false,
                  "description": "Access token can be found in the response body, meaning authentication succeded",
                  "display_name": "Authentication Suceeded",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01FE9PMOEF4KS67e1oEAivsm3tHkrQLRdtQ",
                    "name": "While Loop",
                    "title": "While Loop to check workstation discovered",
                    "type": "logic.while",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "description": "First loop to check if the VAC has already discovered the workstation. The Management Agent must has been already installed in the workstation in order to see it discovered in the VAC. (Management Agent installation is done in the Veeam Agent Setup workflow from whic the Veeam VAC Backup Agent Management is called as atomic workflow)",
                      "display_name": "While Loop to check workstation discovered",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01FE9PMR3LCCA50sMxaHUL7ULywsbLH1j21",
                        "name": "Condition Branch",
                        "title": "Check if veeam workstation id exist",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": {
                              "left_operand": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FE9SB8BSU3M3LPS0XTGrCQIcM5lsMp1u8$",
                              "operator": "eq",
                              "right_operand": "null"
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FGULDZQUH253YL4FCLRMica8cqsRTVMrJ$",
                              "operator": "gt",
                              "right_operand": 0
                            }
                          },
                          "continue_on_failure": false,
                          "description": "Check if Veeam has already associated an ID to the Workstation, meaning that it has been already discovered.\nThe second condition relates to a counter for limit the number of loops.",
                          "display_name": "Check if veeam workstation id exist",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01FE9MMT6YW6T0h089pnJEdI9EzfSLjO1BY",
                            "name": "HTTP Request",
                            "title": "Get All Discovered Computer",
                            "type": "web-service.http_request",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "allow_auto_redirect": true,
                              "continue_on_error_status_code": false,
                              "continue_on_failure": false,
                              "custom_headers": [
                                {
                                  "name": "Authorization",
                                  "value": "Bearer $activity.definition_activity_01FBPPR3WMFBP5yDzIhtuVVKCjuyQFlvGJz.output.jsonpath_queries.access_token$"
                                }
                              ],
                              "description": "HTTP GET Request to the API exposed by VAC in order to get the list of all discovered computer",
                              "display_name": "Get All Discovered Computer",
                              "method": "GET",
                              "relative_url": "api/v3/discovery/computers",
                              "runtime_user": {
                                "override_target_runtime_user": false,
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target": false,
                                "override_workflow_target_group_criteria": false,
                                "use_workflow_target": true,
                                "use_workflow_target_group": false
                              }
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01FE9U6Y2IACB2ZcJp5tRiLcwDWtCXE9b7p",
                            "name": "Condition Block",
                            "title": "Has the workstation been discovered?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "description": "Check if it exists a Veeam unique identifier (UID) associated to the specific workstation",
                              "display_name": "Has the workstation been discovered?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01FE9U70HLLSI57weU6Jg1JOXnyBUwWU8uJ",
                                "name": "Condition Branch",
                                "title": "No workstation id found among discovered computers",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": {
                                      "left_operand": "$activity.definition_activity_01FE9MMT6YW6T0h089pnJEdI9EzfSLjO1BY.output.response_body$",
                                      "operator": "nmw",
                                      "right_operand": "*$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FC90D4QFUJJ4DMdybvmSfpV3vVppPFS9l$*"
                                    },
                                    "operator": "and",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_01FE9MMT6YW6T0h089pnJEdI9EzfSLjO1BY.output.response_body$",
                                      "operator": "nmw",
                                      "right_operand": "*$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FGQMN2OU5XL0HXJ51sTLitZhvtdGRFTvo$*"
                                    }
                                  },
                                  "continue_on_failure": false,
                                  "description": "Workstation ID and IP address have not been found in the response body of HTTP GET discovered computers. Meaning that the workstation we want to backup is not among discovered computers.\nThere are two conditions (ID and IP address) because Veeam associates a hostname to AWS workstation different from the one associated by Cloud Clenter Suite, meaning that we cannot use as input to query the body of HTTP GET response from Veeam API. (When using this workflow as atomic into the Veeam agent setup, the ideal condition would be having correlations between hostnames and ID between Veeam and CCS for AWS cloud.) \n",
                                  "display_name": "No workstation id found among discovered computers",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01FE9WJDIG7GN02GJcjXX82npWEgKgB6ZTa",
                                    "name": "Sleep",
                                    "title": "Sleep",
                                    "type": "core.sleep",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "description": "Sleep to wait before to retry the loop",
                                      "display_name": "Sleep",
                                      "skip_execution": false,
                                      "sleep_interval": 10
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01FGUM3YGWF2820OYcV0GiqSKIMP5srVbK6",
                                    "name": "Set Variables",
                                    "title": "Decrease Loop Counter",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "description": "Decrese the counter used for limiting the number of loops",
                                      "display_name": "Decrease Loop Counter",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FGULDZQUH253YL4FCLRMica8cqsRTVMrJ$",
                                          "variable_value_new": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FGULDZQUH253YL4FCLRMica8cqsRTVMrJ$ - 1"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01FE9U71D3HEJ6wQyZE6wrczaKcDAEBBeZV",
                                "name": "Condition Branch",
                                "title": "workstation id found among discovered computers",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": {
                                      "left_operand": "$activity.definition_activity_01FE9MMT6YW6T0h089pnJEdI9EzfSLjO1BY.output.response_body$",
                                      "operator": "mw",
                                      "right_operand": "*$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FC90D4QFUJJ4DMdybvmSfpV3vVppPFS9l$*"
                                    },
                                    "operator": "or",
                                    "right_operand": {
                                      "left_operand": "$activity.definition_activity_01FE9MMT6YW6T0h089pnJEdI9EzfSLjO1BY.output.response_body$",
                                      "operator": "mw",
                                      "right_operand": "*$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FGQMN2OU5XL0HXJ51sTLitZhvtdGRFTvo$*"
                                    }
                                  },
                                  "continue_on_failure": false,
                                  "description": "wokstation ID found in the response body of previous HTTP request ",
                                  "display_name": "workstation id found among discovered computers",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01FGRKE8NQG4K5A1tKUFxyzXGSZOSgdRmwW",
                                    "name": "Condition Block",
                                    "title": "Check cloud environment",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Check cloud environment",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01FGRKEBCV8O15JXaxiZt4R6S22RH4g5pyY",
                                        "name": "Condition Branch",
                                        "title": "If cloud == AWS",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FGRK4F7QTTF3EVDAvqF9fJmXZB1rfdTfj$",
                                            "operator": "eq",
                                            "right_operand": "Amazon"
                                          },
                                          "continue_on_failure": false,
                                          "description": "Se l'environment è AWS, allora significa che c'è stato un match sull'IP Address. Dunque dobbiamo ottenere il Veeam UID associato alla workstation ma anche l'hostname che Veeam da alla workstation (diverso da quello di CCS)",
                                          "display_name": "If cloud == AWS",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01FGRM7Q7KGNA5IfklYnOM19Dw4uuoBvA0U",
                                            "name": "JSONPath Query",
                                            "title": "Get AWS Workstation UID",
                                            "type": "corejava.jsonpathquery",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "description": "Get the Veeam UID and the hostname of the workstation.",
                                              "display_name": "Get AWS Workstation UID",
                                              "input_json": "$activity.definition_activity_01FE9MMT6YW6T0h089pnJEdI9EzfSLjO1BY.output.response_body$",
                                              "jsonpath_queries": [
                                                {
                                                  "jsonpath_query": "$.data[?(@.info.ipAddresses[0]==\"$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FGQMN2OU5XL0HXJ51sTLitZhvtdGRFTvo$\")].instanceUid",
                                                  "jsonpath_query_name": "veeam AWS workstation id",
                                                  "jsonpath_query_type": "string"
                                                },
                                                {
                                                  "jsonpath_query": "$.data[?(@.info.ipAddresses[0]==\"$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FGQMN2OU5XL0HXJ51sTLitZhvtdGRFTvo$\")].info.hostName",
                                                  "jsonpath_query_name": "hostname_aws",
                                                  "jsonpath_query_type": "string"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01FGROBVJCBG22FIXIpLxKRFZ6wAhV5MeWK",
                                            "name": "Set Variables",
                                            "title": "Update AWS Veeam Variables",
                                            "type": "core.set_multiple_variables",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "description": "Store values into variables to use them out of the loop",
                                              "display_name": "Update AWS Veeam Variables",
                                              "skip_execution": false,
                                              "variables_to_update": [
                                                {
                                                  "variable_to_update": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FE9SB8BSU3M3LPS0XTGrCQIcM5lsMp1u8$",
                                                  "variable_value_new": "$activity.definition_activity_01FGRM7Q7KGNA5IfklYnOM19Dw4uuoBvA0U.output.jsonpath_queries.veeam AWS workstation id$"
                                                },
                                                {
                                                  "variable_to_update": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FC90D4QFUJJ4DMdybvmSfpV3vVppPFS9l$",
                                                  "variable_value_new": "$activity.definition_activity_01FGRM7Q7KGNA5IfklYnOM19Dw4uuoBvA0U.output.jsonpath_queries.hostname_aws$"
                                                }
                                              ]
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      },
                                      {
                                        "unique_name": "definition_activity_01FGRKEC86DAN6ERfFzjCRjLbRBHQxkpjTK",
                                        "name": "Condition Branch",
                                        "title": "If cloud in not == AWS",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FGRK4F7QTTF3EVDAvqF9fJmXZB1rfdTfj$",
                                            "operator": "ne",
                                            "right_operand": "Amazon"
                                          },
                                          "continue_on_failure": false,
                                          "description": "If cloud is GCP, Veeam and CCS has same values to identify workstation hostname. This has been verified only for GCP.",
                                          "display_name": "If cloud in not == AWS",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01FEA0OMAXZRS601d2O2mB3KJZBgjgf9J6i",
                                            "name": "JSONPath Query",
                                            "title": "Get Veeam Workstation UID",
                                            "type": "corejava.jsonpathquery",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": false,
                                              "description": "Get the Veeam UID of the workstation.",
                                              "display_name": "Get Veeam Workstation UID",
                                              "input_json": "$activity.definition_activity_01FE9MMT6YW6T0h089pnJEdI9EzfSLjO1BY.output.response_body$",
                                              "jsonpath_queries": [
                                                {
                                                  "jsonpath_query": "$.data[?(@.info.hostName == \"$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FC90D4QFUJJ4DMdybvmSfpV3vVppPFS9l$\")].instanceUid",
                                                  "jsonpath_query_name": "veeam workstation ID",
                                                  "jsonpath_query_type": "string"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01FEA28O5QS43751OtjSlqSs1GS31qmOBOH",
                                            "name": "Set Variables",
                                            "title": "Update Veeam Workstation UID Variable",
                                            "type": "core.set_multiple_variables",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "description": "Store value into variable to use them out of the loop",
                                              "display_name": "Update Veeam Workstation UID Variable",
                                              "skip_execution": false,
                                              "variables_to_update": [
                                                {
                                                  "variable_to_update": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FE9SB8BSU3M3LPS0XTGrCQIcM5lsMp1u8$",
                                                  "variable_value_new": "$activity.definition_activity_01FEA0OMAXZRS601d2O2mB3KJZBgjgf9J6i.output.jsonpath_queries.veeam workstation ID$"
                                                }
                                              ]
                                            },
                                            "object_type": "definition_activity"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01FEA3L7Q70750R6pxT5ok1dDDunJxoCvba",
                    "name": "HTTP Request",
                    "title": "Install Backup Agents",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "body": "{\n\n \"setReadOnlyAccess\": true,\n\n \"installCbtDriver\": true\n\n}",
                      "content_type": "application/json",
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "custom_headers": [
                        {
                          "name": "Authorization",
                          "value": "Bearer $activity.definition_activity_01FBPPR3WMFBP5yDzIhtuVVKCjuyQFlvGJz.output.jsonpath_queries.access_token$"
                        }
                      ],
                      "description": "HTTP GET request to install the Backup Agent on the workstation.",
                      "display_name": "Install Backup Agents",
                      "method": "POST",
                      "relative_url": "api/v3/discovery/computers/$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FE9SB8BSU3M3LPS0XTGrCQIcM5lsMp1u8$/installBackupAgent",
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": false,
                        "override_workflow_target_group_criteria": false,
                        "use_workflow_target": true,
                        "use_workflow_target_group": false
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01FF3H5JH094D3ABEPtbZOtK7ACByDnJdrR",
                    "name": "Set Variables",
                    "title": "Reset Loop Counter",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "description": "Reset loop counter to the maximum number of loops possible",
                      "display_name": "Reset Loop Counter",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FGULDZQUH253YL4FCLRMica8cqsRTVMrJ$",
                          "variable_value_new": 20
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01FCK5NTJBX6X0lwf96woJJYtKRXIA64cgs",
                    "name": "While Loop",
                    "title": "While LOOP to wait Backup Agent discovery ",
                    "type": "logic.while",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "description": "Wait before the Backup agent isntallation succeded",
                      "display_name": "While LOOP to wait Backup Agent discovery ",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01FCK5NWGPH4B3lj9Js5uTOYCsO4vUcPfGw",
                        "name": "Condition Branch",
                        "title": "Check if backup agents ID exist",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": {
                              "left_operand": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FCK4Q2SIA5L2XnY9gSk315hocP6eQNLnt$",
                              "operator": "eq",
                              "right_operand": "null"
                            },
                            "operator": "and",
                            "right_operand": {
                              "left_operand": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FGULDZQUH253YL4FCLRMica8cqsRTVMrJ$",
                              "operator": "gt",
                              "right_operand": 0
                            }
                          },
                          "continue_on_failure": false,
                          "description": "Check if Veeam has already defined a Backup UID asociated to the workstation. The Backup UID is different from the Workstation UID seen in the previous loop. The Backup ID is associated when the Backup Agent in installed and activated, so when the workstation is in the managed mode.",
                          "display_name": "Check if backup agents ID exist",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01FAYMZXXRYCW3D6JnwPn8OlBfnl55Iwr4Z",
                            "name": "HTTP Request",
                            "title": "Get All Backup Agents",
                            "type": "web-service.http_request",
                            "base_type": "activity",
                            "properties": {
                              "accept": "application/json",
                              "action_timeout": 180,
                              "allow_auto_redirect": true,
                              "continue_on_error_status_code": false,
                              "continue_on_failure": false,
                              "custom_headers": [
                                {
                                  "name": "Authorization",
                                  "value": "Bearer $activity.definition_activity_01FBPPR3WMFBP5yDzIhtuVVKCjuyQFlvGJz.output.jsonpath_queries.access_token$"
                                }
                              ],
                              "description": "HTTP GET request to get all the backups agents VAC has installed so far",
                              "display_name": "Get All Backup Agents",
                              "method": "GET",
                              "relative_url": "api/v3/infrastructure/backupAgents",
                              "runtime_user": {
                                "override_target_runtime_user": false,
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target": false,
                                "override_workflow_target_group_criteria": false,
                                "use_workflow_target": true,
                                "use_workflow_target_group": false
                              }
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01FCKE1JVHETR6nXEnthSSZtV6wZOeU2Ieq",
                            "name": "Condition Block",
                            "title": "HAS the backup agent been discovered?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "description": "Check if the Backup UID associated to the workstation is found in the response body",
                              "display_name": "HAS the backup agent been discovered?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01FCKE1M3YMR42oPl3q846U4PZG43n8mnGH",
                                "name": "Condition Branch",
                                "title": "No Backup UID found",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01FAYMZXXRYCW3D6JnwPn8OlBfnl55Iwr4Z.output.response_body$",
                                    "operator": "nmw",
                                    "right_operand": "*$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FC90D4QFUJJ4DMdybvmSfpV3vVppPFS9l$*"
                                  },
                                  "continue_on_failure": false,
                                  "description": "The workstation hostname can't be found among discovered backup Agents, meaning the installation of the Backup Agent is not completed yet.",
                                  "display_name": "No Backup UID found",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01FCKJ9FSVL032z2DJwAGgVBwxVELvVkMiI",
                                    "name": "Sleep",
                                    "title": "Sleep",
                                    "type": "core.sleep",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "description": "Sleep to wait before to retry the loop",
                                      "display_name": "Sleep",
                                      "skip_execution": false,
                                      "sleep_interval": 20
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01FGUOVGQJH4D6y8fjIvOLnOoLDTrs0Kl2Z",
                                    "name": "Set Variables",
                                    "title": "Decrease Loop Counter",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "description": "Decrese the counter used for limiting the number of loops",
                                      "display_name": "Decrease Loop Counter",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FGULDZQUH253YL4FCLRMica8cqsRTVMrJ$",
                                          "variable_value_new": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FGULDZQUH253YL4FCLRMica8cqsRTVMrJ$ - 1"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01FCKE1MZUF3P3luX82NYthZgglwLvhBSDA",
                                "name": "Condition Branch",
                                "title": "Workstation ID found",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01FAYMZXXRYCW3D6JnwPn8OlBfnl55Iwr4Z.output.response_body$",
                                    "operator": "mw",
                                    "right_operand": "*$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FC90D4QFUJJ4DMdybvmSfpV3vVppPFS9l$*"
                                  },
                                  "continue_on_failure": false,
                                  "description": "A Backup Agent UID associated to the workstation hostname has been found, meaning the backup agent installation succeded.",
                                  "display_name": "Workstation ID found",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01FE9ZJMK7FW62luHEMq5dHphSZoVJQEDoO",
                                    "name": "JSONPath Query",
                                    "title": "Get Veeam Backup Agent UID",
                                    "type": "corejava.jsonpathquery",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "description": "JsonPath query to get the Backup Agent UID ",
                                      "display_name": "Get Veeam Backup Agent UID",
                                      "input_json": "$activity.definition_activity_01FAYMZXXRYCW3D6JnwPn8OlBfnl55Iwr4Z.output.response_body$",
                                      "jsonpath_queries": [
                                        {
                                          "jsonpath_query": "$.data.[?(@.name==\"$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FC90D4QFUJJ4DMdybvmSfpV3vVppPFS9l$\")].instanceUid",
                                          "jsonpath_query_name": "BackupAgentID",
                                          "jsonpath_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01FCKNIL3HAZ36UHzn0Lf0Bx5VnqRHXnqbD",
                                    "name": "Set Variables",
                                    "title": "Update Veeam Backup Agent UID Variable",
                                    "type": "core.set_multiple_variables",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "description": "Update Backup Agent UID variable",
                                      "display_name": "Update Veeam Backup Agent UID Variable",
                                      "skip_execution": false,
                                      "variables_to_update": [
                                        {
                                          "variable_to_update": "$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FCK4Q2SIA5L2XnY9gSk315hocP6eQNLnt$",
                                          "variable_value_new": "$activity.definition_activity_01FE9ZJMK7FW62luHEMq5dHphSZoVJQEDoO.output.jsonpath_queries.BackupAgentID$"
                                        }
                                      ]
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01FC8VBSSU00X5mCuYAleKYt0ZeJYhzJd0L",
                    "name": "HTTP Request",
                    "title": "Get Available Backup Policies",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "accept": "application/json",
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "custom_headers": [
                        {
                          "name": "Authorization",
                          "value": "Bearer $activity.definition_activity_01FBPPR3WMFBP5yDzIhtuVVKCjuyQFlvGJz.output.jsonpath_queries.access_token$"
                        }
                      ],
                      "description": "HTTP GET request to get the policies already defined in the VAC",
                      "display_name": "Get Available Backup Policies",
                      "method": "GET",
                      "relative_url": "api/v3/configuration/backupPolicies",
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": false,
                        "override_workflow_target_group_criteria": false,
                        "use_workflow_target": true,
                        "use_workflow_target_group": false
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01FC92IAO5N5V3pCuXP8sV4PUbZIkFfiBgy",
                    "name": "JSONPath Query",
                    "title": "Get Veeam Backup Policy ID",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "description": "Get the Veam Backup Policy ID of the specific policy in input",
                      "display_name": "Get Veeam Backup Policy ID",
                      "input_json": "$activity.definition_activity_01FC8VBSSU00X5mCuYAleKYt0ZeJYhzJd0L.output.response_body$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.data.[?(@.name==\"$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.input.variable_workflow_01FC8YKL5AC2838ClnJtivjwkt6RiIMW6oU$\")].instanceUid",
                          "jsonpath_query_name": "Backup Policy ID",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01FEVSTLR2TLV7Q87j0Bq4YAlqj1dn2KXWF",
                    "name": "HTTP Request",
                    "title": "Assign Veeam Backup Policy To Workstation",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "custom_headers": [
                        {
                          "name": "Authorization",
                          "value": "Bearer $activity.definition_activity_01FBPPR3WMFBP5yDzIhtuVVKCjuyQFlvGJz.output.jsonpath_queries.access_token$"
                        }
                      ],
                      "description": "Assign the Veeam Backup Policy to the workstation",
                      "display_name": "Assign Veeam Backup Policy To Workstation",
                      "method": "POST",
                      "relative_url": "api/v3/infrastructure/backupAgents/windows/$workflow.definition_workflow_01FAVVWY1S4J71UfUDphtO7C6C8uWMqwg5X.local.variable_workflow_01FCK4Q2SIA5L2XnY9gSk315hocP6eQNLnt$/assignedPolicies?policyUid=$activity.definition_activity_01FC92IAO5N5V3pCuXP8sV4PUbZIkFfiBgy.output.jsonpath_queries.Backup Policy ID$",
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": false,
                        "override_workflow_target_group_criteria": false,
                        "use_workflow_target": true,
                        "use_workflow_target_group": false
                      }
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      }
    }
  ],
  "atomic_workflows": [
    "definition_workflow_01gD85jbeDkSP5TO2AYeuvkAJkbgBWyhY"
  ]
}